---
title: "p8105_hw2_bz2570"
author: "Boran Zhai"
date: "2025-09-30"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(readr)
library(lubridate)
```

## Problem 1

#### (1) Clean the data in pols-month.csv
Use separate() to break up the variable mon into integer variables year, month, and day; replace month number with month name; create a president variable taking values gop and dem, and remove prez_dem and prez_gop; and remove the day variable.
```{r}
pols_month <- read_csv("./data/pols-month.csv") |> 
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day),
    month = month.abb[month],
    president = ifelse(prez_gop == 1, "gop", 
                       ifelse(prez_dem == 1, "dem",NA))
  ) |>
  select(-prez_dem, -prez_gop, -day)
pols_month
```

#### (2) Clean the data in snp.csv 
using a similar process to the above. For consistency across datasets, arrange according to year and month, and organize so that year and month are the leading columns.
```{r}
snp <- read_csv("./data/snp.csv") |> 
  janitor::clean_names() |> 
  separate(date, into = c("month", "day", "year"), sep = "/") |> 
  mutate(
    year = as.integer(year),
    year = ifelse(year >= 50, 1900 + year, 2000 + year),
    month = as.integer(month),
    day = as.integer(day),
    month = month.abb[month]
  ) |>
  select(year,month,close) |>
  arrange(year, match(month, month.abb))
snp
```

#### (3) Tidy the unemployment data
This process will involve switching from “wide” to “long” format; ensuring that key variables have the same name; and ensuring that key variables take the same values.
```{r}
unemployment_tidy <- read_csv("./data/unemployment.csv") |> 
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "unemployment_rate"
  ) |>
  mutate(
    unemployment_rate = as.numeric(unemployment_rate)
  ) |>
  rename(year = Year)
unemployment_tidy 
```

#### (4) Join the datasets by merging snp into pols, and merging unemployment into the result.
```{r}
data_0 <- pols_month |>
  left_join(snp, by = c("year", "month")) |>
  left_join(unemployment_tidy, by = c("year", "month")) |>
  arrange(year, match(month, month.abb))
data_0
```

Note(useing date variable)
```{r}
data_1 <- pols_month |>
  left_join(snp, by = c("year", "month")) |>
  left_join(unemployment_tidy, by = c("year", "month")) |>
  mutate(date = str_c(year, "-", sprintf("%02d", match(month, month.abb))))|> 
  relocate(date) |> 
  select(-year,-month) |> 
  arrange(date)
data_1
```

#### Write a short paragraph about these datasets. 
The final dataset combines three datasets tracking political and economic indicators. After cleaning and tidying three dataset separately, the pols-month dataset contains 822 observations of 9 variables related to the number of national politicians who are democratic or republican at any given time, including presidential party indicators and counts of politicians across governors, senators, and representatives; The snp dataset contains 787 observations of 3 variables related to Standard & Poor's stock market index, including the year and month of observation and closing values of the S&P stock index; The unemployment dataset contains 816 observations of 3 variables related to monthly unemployment percentages across different years, including the year of measurement and unemployment rates for each month from January to December. After merging three datasets, the resulting dataset contains 822 observations monthly spanning from 1947 to 2015 across 11 variables. Key variables include year, month, political composition indicators (gov_gop, sen_gop, rep_gop, gov_dem, sen_dem, rep_dem), presidential party, S&P closing values, unemployment rates. However, while the political data covers the full 1947-2015 period, the economic indicators have some missing values in earlier years, with S&P data beginning in 1950 and unemployment data in 1948. 
