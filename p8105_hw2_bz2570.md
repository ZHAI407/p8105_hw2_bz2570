p8105_hw2_bz2570
================
Boran Zhai
2025-09-30

## Problem 1

#### (1) Clean the data in pols-month.csv

Use separate() to break up the variable mon into integer variables year,
month, and day; replace month number with month name; create a president
variable taking values gop and dem, and remove prez_dem and prez_gop;
and remove the day variable.

``` r
pols_month <- read_csv("./data/pols-month.csv") |> 
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day),
    month = month.abb[month],
    president = ifelse(prez_gop == 1, "gop", 
                       ifelse(prez_dem == 1, "dem",NA))
  ) |>
  select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
pols_month
```

    ## # A tibble: 822 × 9
    ##     year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 Jan        23      51     253      23      45     198 dem      
    ##  2  1947 Feb        23      51     253      23      45     198 dem      
    ##  3  1947 Mar        23      51     253      23      45     198 dem      
    ##  4  1947 Apr        23      51     253      23      45     198 dem      
    ##  5  1947 May        23      51     253      23      45     198 dem      
    ##  6  1947 Jun        23      51     253      23      45     198 dem      
    ##  7  1947 Jul        23      51     253      23      45     198 dem      
    ##  8  1947 Aug        23      51     253      23      45     198 dem      
    ##  9  1947 Sep        23      51     253      23      45     198 dem      
    ## 10  1947 Oct        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

#### (2) Clean the data in snp.csv

using a similar process to the above. For consistency across datasets,
arrange according to year and month, and organize so that year and month
are the leading columns.

``` r
snp <- read_csv("./data/snp.csv") |> 
  janitor::clean_names() |> 
  separate(date, into = c("month", "day", "year"), sep = "/") |> 
  mutate(
    year = as.integer(year),
    year = ifelse(year >= 50, 1900 + year, 2000 + year),
    month = as.integer(month),
    day = as.integer(day),
    month = month.abb[month]
  ) |>
  select(year,month,close) |>
  arrange(year, match(month, month.abb))
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp
```

    ## # A tibble: 787 × 3
    ##     year month close
    ##    <dbl> <chr> <dbl>
    ##  1  1950 Jan    17.0
    ##  2  1950 Feb    17.2
    ##  3  1950 Mar    17.3
    ##  4  1950 Apr    18.0
    ##  5  1950 May    18.8
    ##  6  1950 Jun    17.7
    ##  7  1950 Jul    17.8
    ##  8  1950 Aug    18.4
    ##  9  1950 Sep    19.5
    ## 10  1950 Oct    19.5
    ## # ℹ 777 more rows

#### (3) Tidy the unemployment data

This process will involve switching from “wide” to “long” format;
ensuring that key variables have the same name; and ensuring that key
variables take the same values.

``` r
unemployment_tidy <- read_csv("./data/unemployment.csv") |> 
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "unemployment_rate"
  ) |>
  mutate(
    unemployment_rate = as.numeric(unemployment_rate)
  ) |>
  rename(year = Year)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemployment_tidy 
```

    ## # A tibble: 816 × 3
    ##     year month unemployment_rate
    ##    <dbl> <chr>             <dbl>
    ##  1  1948 Jan                 3.4
    ##  2  1948 Feb                 3.8
    ##  3  1948 Mar                 4  
    ##  4  1948 Apr                 3.9
    ##  5  1948 May                 3.5
    ##  6  1948 Jun                 3.6
    ##  7  1948 Jul                 3.6
    ##  8  1948 Aug                 3.9
    ##  9  1948 Sep                 3.8
    ## 10  1948 Oct                 3.7
    ## # ℹ 806 more rows

#### (4) Join the datasets by merging snp into pols, and merging unemployment into the result.

``` r
data_0 <- pols_month |>
  left_join(snp, by = c("year", "month")) |>
  left_join(unemployment_tidy, by = c("year", "month")) |>
  arrange(year, match(month, month.abb))
data_0
```

    ## # A tibble: 822 × 11
    ##     year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 Jan        23      51     253      23      45     198 dem          NA
    ##  2  1947 Feb        23      51     253      23      45     198 dem          NA
    ##  3  1947 Mar        23      51     253      23      45     198 dem          NA
    ##  4  1947 Apr        23      51     253      23      45     198 dem          NA
    ##  5  1947 May        23      51     253      23      45     198 dem          NA
    ##  6  1947 Jun        23      51     253      23      45     198 dem          NA
    ##  7  1947 Jul        23      51     253      23      45     198 dem          NA
    ##  8  1947 Aug        23      51     253      23      45     198 dem          NA
    ##  9  1947 Sep        23      51     253      23      45     198 dem          NA
    ## 10  1947 Oct        23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: unemployment_rate <dbl>

Note(useing date variable)

``` r
data_1 <- pols_month |>
  left_join(snp, by = c("year", "month")) |>
  left_join(unemployment_tidy, by = c("year", "month")) |>
  mutate(date = str_c(year, "-", sprintf("%02d", match(month, month.abb))))|> 
  relocate(date) |> 
  select(-year,-month) |> 
  arrange(date)
data_1
```

    ## # A tibble: 822 × 10
    ##    date    gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1 1947-01      23      51     253      23      45     198 dem          NA
    ##  2 1947-02      23      51     253      23      45     198 dem          NA
    ##  3 1947-03      23      51     253      23      45     198 dem          NA
    ##  4 1947-04      23      51     253      23      45     198 dem          NA
    ##  5 1947-05      23      51     253      23      45     198 dem          NA
    ##  6 1947-06      23      51     253      23      45     198 dem          NA
    ##  7 1947-07      23      51     253      23      45     198 dem          NA
    ##  8 1947-08      23      51     253      23      45     198 dem          NA
    ##  9 1947-09      23      51     253      23      45     198 dem          NA
    ## 10 1947-10      23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: unemployment_rate <dbl>

#### Write a short paragraph about these datasets.

The final dataset combines three datasets tracking political and
economic indicators. After cleaning and tidying three dataset
separately, the pols-month dataset contains 822 observations of 9
variables related to the number of national politicians who are
democratic or republican at any given time, including presidential party
indicators and counts of politicians across governors, senators, and
representatives; The snp dataset contains 787 observations of 3
variables related to Standard & Poor’s stock market index, including the
year and month of observation and closing values of the S&P stock index;
The unemployment dataset contains 816 observations of 3 variables
related to monthly unemployment percentages across different years,
including the year of measurement and unemployment rates for each month
from January to December. After merging three datasets, the resulting
dataset contains 822 observations monthly spanning from 1947 to 2015
across 11 variables. Key variables include year, month, political
composition indicators (gov_gop, sen_gop, rep_gop, gov_dem, sen_dem,
rep_dem), presidential party, S&P closing values, unemployment rates.
However, while the political data covers the full 1947-2015 period, the
economic indicators have some missing values in earlier years, with S&P
data beginning in 1950 and unemployment data in 1948.

## Problem 2

#### (1)

Read and clean the Mr. Trash Wheel sheet 1)specify the sheet in the
Excel file and to omit non-data entries using arguments in read_excel
2)use reasonable variable names 3)omit rows that do not include
dumpster-specific data 4)round the number of sports balls to the nearest
integer and converts the result to an integer variable (using
as.integer)

``` r
mr_tidy <- read_excel("./data/202509 Trash Wheel Collection Data.xlsx", 
                       sheet = "Mr. Trash Wheel",
                       skip = 1,
                       na = c(".", "NA", "")) |>  
  janitor::clean_names() |>  
  filter(!is.na(dumpster)) |> 
  mutate(
    sports_balls = as.integer(round(sports_balls)), 
    year = as.integer(year)
  )
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

#### (2)

Use a similar process to import, clean, and organize the data for
Professor Trash Wheel and Gwynnda, and combine this with the Mr. Trash
Wheel dataset to produce a single tidy dataset. To keep track of which
Trash Wheel is which, you may need to add an additional variable to both
datasets before combining.

Read and clean Professor Trash Wheel data

``` r
professor_tidy <- read_excel("./data/202509 Trash Wheel Collection Data.xlsx",
                        sheet = "Professor Trash Wheel",
                        skip = 1,
                        na = c(".", "NA", "")) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |> 
  mutate(
    year = as.integer(year)
  )
professor_tidy
```

    ## # A tibble: 132 × 13
    ##    dumpster month     year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr>    <int> <dttm>                    <dbl>              <dbl>
    ##  1        1 January   2017 2017-01-02 00:00:00        1.79                 15
    ##  2        2 January   2017 2017-01-30 00:00:00        1.58                 15
    ##  3        3 February  2017 2017-02-26 00:00:00        2.32                 18
    ##  4        4 February  2017 2017-02-26 00:00:00        3.72                 15
    ##  5        5 February  2017 2017-02-28 00:00:00        1.45                 15
    ##  6        6 March     2017 2017-03-30 00:00:00        1.71                 15
    ##  7        7 April     2017 2017-04-01 00:00:00        1.82                 15
    ##  8        8 April     2017 2017-04-20 00:00:00        2.37                 15
    ##  9        9 May       2017 2017-05-10 00:00:00        2.64                 15
    ## 10       10 May       2017 2017-05-26 00:00:00        2.78                 15
    ## # ℹ 122 more rows
    ## # ℹ 7 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, homes_powered <dbl>

Read and clean Gwynnda data

``` r
gwynnda_tidy <- read_excel("./data/202509 Trash Wheel Collection Data.xlsx",
                     sheet = "Gwynns Falls Trash Wheel",
                     skip = 1,
                     na = c(".", "NA", "")) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |> 
  mutate(
    year = as.integer(year)
  )
gwynnda_tidy
```

    ## # A tibble: 349 × 12
    ##    dumpster month   year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr>  <int> <dttm>                    <dbl>              <dbl>
    ##  1        1 July    2021 2021-07-03 00:00:00        0.93                 15
    ##  2        2 July    2021 2021-07-07 00:00:00        2.26                 15
    ##  3        3 July    2021 2021-07-07 00:00:00        1.62                 15
    ##  4        4 July    2021 2021-07-16 00:00:00        1.76                 15
    ##  5        5 July    2021 2021-07-30 00:00:00        1.53                 15
    ##  6        6 August  2021 2021-08-11 00:00:00        2.06                 15
    ##  7        7 August  2021 2021-08-14 00:00:00        1.9                  15
    ##  8        8 August  2021 2021-08-16 00:00:00        2.16                 15
    ##  9        9 August  2021 2021-08-16 00:00:00        2.6                  15
    ## 10       10 August  2021 2021-08-17 00:00:00        3.21                 15
    ## # ℹ 339 more rows
    ## # ℹ 6 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, plastic_bags <dbl>, wrappers <dbl>,
    ## #   homes_powered <dbl>

Add an additional variable to both datasets before combining

``` r
mr_tidy <- mr_tidy |> 
  mutate(trash_wheel = "Mr. Trash Wheel")
professor_tidy <- professor_tidy |> 
  mutate(trash_wheel = "Professor Trash Wheel")
gwynnda_tidy <- gwynnda_tidy |> 
  mutate(trash_wheel = "Gwynnda")
mr_tidy
```

    ## # A tibble: 707 × 17
    ##    dumpster month  year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <int> <dttm>                    <dbl>              <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31                 18
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74                 13
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45                 15
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1                  15
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06                 18
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71                 13
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91                  8
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7                  16
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52                 14
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76                 18
    ## # ℹ 697 more rows
    ## # ℹ 11 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>, x15 <lgl>,
    ## #   x16 <lgl>, trash_wheel <chr>

Combine this with the Mr. Trash Wheel dataset to produce a single tidy
dataset

``` r
combined_trash <- bind_rows(mr_tidy, professor_tidy, gwynnda_tidy) |> 
  select(where(~!all(is.na(.)))) |> 
  arrange(date)
combined_trash
```

    ## # A tibble: 1,188 × 15
    ##    dumpster month  year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <int> <dttm>                    <dbl>              <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31                 18
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74                 13
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45                 15
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1                  15
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06                 18
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71                 13
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91                  8
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7                  16
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52                 14
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76                 18
    ## # ℹ 1,178 more rows
    ## # ℹ 9 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>, trash_wheel <chr>

#### Write a paragraph about these data

The resulting dataset combines trash collection data from three separate
devices operating in Baltimore’s Inner Harbor: Mr. Trash Wheel,
Professor Trash Wheel, and Gwynns Falls Trash Wheel. The resulting
dataset contains 1188 observations tracking waste collection with 15
variables. Key variables include dumpster identification numbers,
collection dates, total weight of trash, the number of some specific
waste categories such as plastic bottles, polystyrene, cigarette butts,
and the trash wheel identifier to track the source device.<br>(All the
variables are:dumpster, month, year, date, weight_tons,
volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts,
glass_bottles, plastic_bags, wrappers, sports_balls, homes_powered,
trash_wheel).<br> Based on the available data, the total weight of trash
collected by Professor Trash Wheel is 282.26 tons. During June 2022,
Gwynnda collected 1.812^{4} cigarette butts.

## Problem 3

Import and clean ZIP code dataset

``` r
zip_codes_tidy <- read_csv("./data/Zip Codes.csv",
                           na = c(".", "NA", ""))|>
  janitor::clean_names()|>  
  relocate(zip_code) |> 
  arrange(zip_code)
```

    ## Rows: 322 Columns: 7
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (4): County, County Code, File Date, Neighborhood
    ## dbl (3): State FIPS, County FIPS, ZipCode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
zip_codes_tidy
```

    ## # A tibble: 322 × 7
    ##    zip_code county   state_fips county_code county_fips file_date neighborhood  
    ##       <dbl> <chr>         <dbl> <chr>             <dbl> <chr>     <chr>         
    ##  1    10001 New York         36 061               36061 7/25/07   Chelsea and C…
    ##  2    10002 New York         36 061               36061 7/25/07   Lower East Si…
    ##  3    10003 New York         36 061               36061 7/25/07   Lower East Si…
    ##  4    10004 New York         36 061               36061 7/25/07   Lower Manhatt…
    ##  5    10005 New York         36 061               36061 7/25/07   Lower Manhatt…
    ##  6    10006 New York         36 061               36061 7/25/07   Lower Manhatt…
    ##  7    10007 New York         36 061               36061 7/25/07   Lower Manhatt…
    ##  8    10008 New York         36 061               36061 7/25/07   <NA>          
    ##  9    10009 New York         36 061               36061 7/25/07   Lower East Si…
    ## 10    10010 New York         36 061               36061 7/25/07   Gramercy Park…
    ## # ℹ 312 more rows

Import and clean ZIP ZORI dataset

``` r
zip_zori <- read_csv("./data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv",
                     na = c(".", "NA", "")) |>
  janitor::clean_names()
```

    ## Rows: 149 Columns: 125
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr   (6): RegionType, StateName, State, City, Metro, CountyName
    ## dbl (119): RegionID, SizeRank, RegionName, 2015-01-31, 2015-02-28, 2015-03-3...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
zip_zori_tidy <- zip_zori |> 
  pivot_longer(
  cols = starts_with("x20"),
  names_to = "date",        
  values_to = "zori"        
  ) |>
  mutate(
    date = str_remove(date, "^x"),
    date = str_replace(date,"-","_")
    ) |>  
  relocate(region_name) |> 
  arrange(region_name)
zip_zori_tidy
```

    ## # A tibble: 17,284 × 11
    ##    region_name region_id size_rank region_type state_name state city     metro  
    ##          <dbl>     <dbl>     <dbl> <chr>       <chr>      <chr> <chr>    <chr>  
    ##  1       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  2       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  3       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  4       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  5       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  6       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  7       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  8       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  9       10001     61615      4444 zip         NY         NY    New York New Yo…
    ## 10       10001     61615      4444 zip         NY         NY    New York New Yo…
    ## # ℹ 17,274 more rows
    ## # ℹ 3 more variables: county_name <chr>, date <chr>, zori <dbl>

Merge to create a single, final dataset

``` r
resulting_tidy_data <- zip_zori_tidy |>
  left_join(zip_codes_tidy, by = c("region_name" = "zip_code")) |> 
  select(
    region_name, region_id, size_rank, region_type, 
    state_name, state, city, metro,county, county_name, 
    date, zori, county_code, county_fips, state_fips, file_date,neighborhood
  )
```

    ## Warning in left_join(zip_zori_tidy, zip_codes_tidy, by = c(region_name = "zip_code")): Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 7541 of `x` matches multiple rows in `y`.
    ## ℹ Row 1 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

``` r
resulting_tidy_data
```

    ## # A tibble: 17,516 × 17
    ##    region_name region_id size_rank region_type state_name state city     metro  
    ##          <dbl>     <dbl>     <dbl> <chr>       <chr>      <chr> <chr>    <chr>  
    ##  1       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  2       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  3       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  4       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  5       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  6       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  7       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  8       10001     61615      4444 zip         NY         NY    New York New Yo…
    ##  9       10001     61615      4444 zip         NY         NY    New York New Yo…
    ## 10       10001     61615      4444 zip         NY         NY    New York New Yo…
    ## # ℹ 17,506 more rows
    ## # ℹ 9 more variables: county <chr>, county_name <chr>, date <chr>, zori <dbl>,
    ## #   county_code <chr>, county_fips <dbl>, state_fips <dbl>, file_date <chr>,
    ## #   neighborhood <chr>

Check for completeness

``` r
missing_zips <- zip_codes_tidy |>
  anti_join(zip_zori_tidy, by = c("zip_code" = "region_name")) |>
  select(zip_code, county, neighborhood)
```

#### Briefly describe the resulting tidy dataset.

1.How many total observations exist? How many unique ZIP codes are
included, and how many unique neighborhoods?<br>

The resulting tidy dataset contains 17516 observations with 17
variables. The dataset spans from 2015_01_31 to 2024_08_31, providing a
comprehensive time series of Zillow rental price. All the variables in
this dataset are: dumpster, month, year, date, weight_tons,
volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts,
glass_bottles, plastic_bags, wrappers, sports_balls, homes_powered,
trash_wheel. <br>

Besides, the dataset includes 149 unique ZIP codes and 42 unique
neighborhoods across New York City. The structure also reveals that 5
distinct counties represented in the dataset. <br>

2.Which ZIP codes appear in the ZIP code dataset but not in the Zillow
Rental Price dataset? Using a few illustrative examples discuss why
these ZIP codes might be excluded from the Zillow dataset.

There are 171 ZIP codes that appear in the ZIP code dataset but not in
the Zillow Rental Price dataset. Examples include 11694, 11695,
11697.The details of these three examples are following:<br> -11694 is
located in Queens, specifically in the Rockaways neighborhood.<br>
-11695 is located in Queens, specifically in theRockaways
neighborhood.<br> -11697 is located in Queens, specifically in
theRockaways neighborhood.<br>

These three examples located in the Rockaways area of Queens are likely
excluded from the Zillow dataset. This exclusion is probably due to the
following two reasons: firstly, their relatively remote location and
lower population density lead to insufficient year-round rental
transaction data, which does not meet Zillow’s thresholds for inclusion
in the dataset; secondly, the area may have a larger share of commercial
or recreational area rather than residential areas, resulting in limited
residential rental data.

#### Make a table and comment

For all available ZIP codes, compare rental prices in January 2021 to
prices in January 2020. Make a table that shows the 10 ZIP codes (along
with the borough and neighborhood) with largest drop in price from
January 2020 to 2021.

``` r
covid_rental <- resulting_tidy_data |>
  filter(
    (date == "2020_01_31" | date == "2021_01_31")
  ) |>
  select(region_name, county, neighborhood, date, zori) |>
  pivot_wider(
    names_from = date,
    values_from = zori
  ) |>
  mutate(
    price_change = `2021_01_31` - `2020_01_31`,
    price_change_pct = (`2021_01_31` - `2020_01_31`) / `2020_01_31` * 100
  ) |>
  filter(!is.na(price_change)) |>
  arrange(price_change) |>
  head(10) |>
  rename(
    zip_code = region_name,
    borough = county,
    Jan_2020 = `2020_01_31`,
    Jan_2021 = `2021_01_31`
  ) |>
  select(zip_code, borough, neighborhood, Jan_2020, Jan_2021, price_change, price_change_pct)

cat("Top 10 ZIP codes with largest rental price drops from January 2020 to January 2021:\n")
```

    ## Top 10 ZIP codes with largest rental price drops from January 2020 to January 2021:

``` r
covid_rental |>
  print()
```

    ## # A tibble: 10 × 7
    ##    zip_code borough neighborhood Jan_2020 Jan_2021 price_change price_change_pct
    ##       <dbl> <chr>   <chr>           <dbl>    <dbl>        <dbl>            <dbl>
    ##  1    10007 New Yo… Lower Manha…    6334.    5422.        -913.            -14.4
    ##  2    10069 New Yo… <NA>            4623.    3875.        -748.            -16.2
    ##  3    10009 New Yo… Lower East …    3406.    2692.        -714.            -21.0
    ##  4    10016 New Yo… Gramercy Pa…    3731.    3019.        -712.            -19.1
    ##  5    10001 New Yo… Chelsea and…    4108.    3398.        -710.            -17.3
    ##  6    10002 New Yo… Lower East …    3645.    2935.        -710.            -19.5
    ##  7    10004 New Yo… Lower Manha…    3150.    2444.        -706.            -22.4
    ##  8    10038 New Yo… Lower Manha…    3573.    2876.        -698.            -19.5
    ##  9    10012 New Yo… Greenwich V…    3629.    2942.        -686.            -18.9
    ## 10    10010 New Yo… Gramercy Pa…    3697.    3012.        -685.            -18.5

``` r
table <- covid_rental |>
  mutate(
    across(c(Jan_2020, Jan_2021, price_change), ~round(., 2)),
    price_change_pct = round(price_change_pct, 2)
  ) |>
  rename(
    "ZIP Code" = zip_code,
    "Borough" = borough,
    "Neighborhood" = neighborhood,
    "Jan 2020" = Jan_2020,
    "Jan 2021" = Jan_2021,
    "Price Change" = price_change,
    "Pct Change %" = price_change_pct
  )

options(tibble.width = Inf)
table
```

    ## # A tibble: 10 × 7
    ##    `ZIP Code` Borough  Neighborhood                  `Jan 2020` `Jan 2021`
    ##         <dbl> <chr>    <chr>                              <dbl>      <dbl>
    ##  1      10007 New York Lower Manhattan                    6334.      5422.
    ##  2      10069 New York <NA>                               4623.      3875.
    ##  3      10009 New York Lower East Side                    3406.      2692.
    ##  4      10016 New York Gramercy Park and Murray Hill      3731.      3019.
    ##  5      10001 New York Chelsea and Clinton                4108.      3398.
    ##  6      10002 New York Lower East Side                    3645.      2935.
    ##  7      10004 New York Lower Manhattan                    3150.      2444.
    ##  8      10038 New York Lower Manhattan                    3573.      2876.
    ##  9      10012 New York Greenwich Village and Soho         3629.      2942.
    ## 10      10010 New York Gramercy Park and Murray Hill      3697.      3012.
    ##    `Price Change` `Pct Change %`
    ##             <dbl>          <dbl>
    ##  1          -913.          -14.4
    ##  2          -748.          -16.2
    ##  3          -714.          -21.0
    ##  4          -712.          -19.1
    ##  5          -710.          -17.3
    ##  6          -710.          -19.5
    ##  7          -706.          -22.4
    ##  8          -698.          -19.5
    ##  9          -686.          -18.9
    ## 10          -685.          -18.5
